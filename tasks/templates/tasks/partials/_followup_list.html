{% load choice_labels %}<div class="divide-y divide-gray-700">
    {% for fu in follow_ups %}
    <div class="px-4 py-3 flex items-start justify-between group">
        <div>
            <div class="flex items-center gap-2">
                <span class="text-xs px-2 py-0.5 rounded-full bg-gray-700 text-gray-300">{{ fu.method|choice_label:"contact_method" }}</span>
                <a href="{{ fu.stakeholder.get_absolute_url }}" class="text-xs text-blue-400 hover:text-blue-300">{{ fu.stakeholder }}</a>
                <span class="text-xs text-gray-400">{{ fu.outreach_date|date:"M j, Y g:i A" }}</span>
            </div>
            {% if fu.notes_text %}<p class="text-sm text-gray-300 mt-1">{{ fu.notes_text }}</p>{% endif %}
            {% if fu.response_received %}
            <p class="text-xs text-green-400 mt-1">Response received {{ fu.response_date|date:"M j"|default:"" }}</p>
            {% if fu.response_notes %}<p class="text-sm text-gray-400 mt-1 italic">{{ fu.response_notes }}</p>{% endif %}
            {% elif fu.is_stale %}
            <p class="text-xs text-red-400 mt-1">Overdue â€” no response in {{ fu.follow_up_days }}+ days</p>
            {% elif fu.reminder_enabled %}
            <p class="text-xs text-yellow-400 mt-1">Awaiting response (remind after {{ fu.follow_up_days }} days)</p>
            {% else %}
            <p class="text-xs text-gray-500 mt-1">Awaiting response (no reminder)</p>
            {% endif %}
        </div>
        <div class="flex items-center gap-2">
            {% if fu.response_received %}
            {% if fu.response_notes %}
            <a href="{% url 'notes:create' %}?title=Response from {{ fu.stakeholder|urlencode }}&content={{ fu.response_notes|urlencode }}&task={{ task.pk }}&stakeholder={{ fu.stakeholder.pk }}&date={{ fu.response_date|date:'Y-m-d\TH:i' }}"
               class="text-xs px-2 py-1 bg-blue-900/50 hover:bg-blue-900 text-blue-300 rounded-md transition-colors opacity-0 group-hover:opacity-100">Create Note</a>
            {% endif %}
            <button hx-post="{% url 'tasks:followup_respond' fu.pk %}" hx-target="#followup-list" hx-swap="innerHTML"
                    class="text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-md transition-colors opacity-0 group-hover:opacity-100">Undo</button>
            {% else %}
            <button hx-get="{% url 'tasks:followup_respond' fu.pk %}" hx-target="#followup-form-container" hx-swap="innerHTML"
                    class="text-xs px-2 py-1 bg-green-700 hover:bg-green-600 text-green-100 rounded-md transition-colors opacity-0 group-hover:opacity-100">Mark Responded</button>
            {% endif %}
            <button hx-get="{% url 'tasks:followup_edit' fu.pk %}" hx-target="#followup-form-container" hx-swap="innerHTML"
                    class="text-gray-500 hover:text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity text-xs">Edit</button>
            <button hx-post="{% url 'tasks:followup_delete' fu.pk %}" hx-target="#followup-list" hx-swap="innerHTML"
                    hx-confirm="Delete this follow-up?"
                    class="text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity text-sm">&times;</button>
        </div>
    </div>
    {% empty %}
    <p class="px-4 py-4 text-sm text-gray-500 text-center">No follow-ups</p>
    {% endfor %}
</div>
